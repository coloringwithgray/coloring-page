/*******************************
 *    HIDE DEFAULT CURSOR ON BODY
 *******************************/
.hide-cursor {
  cursor: none !important;
}


/************************************
 *    BASIC PAGE & CONTAINER STYLE
 ************************************/
.hidden {
  display: none !important;
}
.visible {
  display: block !important;
}

html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  width: 100vw;
  overflow: hidden; /* Prevent scrolling */
  background-color: white;
  font-family: 'Amatic SC', sans-serif; /* Optional */
  display: flex;
  align-items: center;
  justify-content: center;
}

/* .container {  (No longer needed for canvas background) */
  position: relative;
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}

/************************************
 *    CANVAS
 ************************************/
##canvas {
  background: white !important;
  width: 100vw !important;
  height: 100vh !important;
  position: fixed !important;
  left: 0;
  top: 0;
  z-index: 1;
}
  position: absolute;
  left: 0;
  top: 0;
  z-index: 1; /* Canvas behind other elements */
  background-color: white;
  background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 80 80"><rect width="80" height="80" fill="white"/><g opacity="0.07"><circle cx="40" cy="40" r="38" fill="none" stroke="gray" stroke-width="1.5"/><ellipse cx="40" cy="40" rx="34" ry="28" fill="none" stroke="gray" stroke-width="1"/><ellipse cx="40" cy="40" rx="28" ry="20" fill="none" stroke="gray" stroke-width="0.7"/></g></svg>');
  background-repeat: repeat;
  background-size: 80px 80px;
}

/************************************
 *    CRAYON
 ************************************/
#crayon {
  /* Remove position/left/top/transform so flexbox can center and pointer events work */
  width: 80px;
  height: auto;
  z-index: 10;
  pointer-events: auto;
  background: none;
  border: none;
  box-shadow: none;
  filter: none;
  transition: transform 0.25s cubic-bezier(.4,0,.2,1);
}

/* Wiggle animation for tactile feedback */
@keyframes crayon-wiggle {
  0% { transform: translate(-50%, -50%) rotate(0deg) scale(1); }
  15% { transform: translate(-50%, -50%) rotate(-13deg) scale(1.08); }
  35% { transform: translate(-50%, -50%) rotate(11deg) scale(1.1); }
  55% { transform: translate(-50%, -50%) rotate(-7deg) scale(1.04); }
  75% { transform: translate(-50%, -50%) rotate(8deg) scale(1.06); }
  100% { transform: translate(-50%, -50%) rotate(0deg) scale(1); }
}
.crayon-wiggle {
  animation: crayon-wiggle 0.55s cubic-bezier(.4,0,.2,1);
}


#crayon.crayon-activated {
  transform: translate(-50%, -50%) scale(1.12);
  box-shadow: none;
  filter: none;
}



#crayon:focus {
  outline: 2px solid #888;
  filter: brightness(1.1) drop-shadow(0 0 6px #bbb);
}

@media (max-width: 600px) {
  #crayon {
    width: 48px;
    max-height: 48px;
  }
}

/************************************
 *    MIRROR LINK (PORTAL)
 ************************************/
#portal-preview {
  position: absolute;
  left: 50%;
  top: 50%;
  width: 64px;
  height: 64px;
  transform: translate(-50%, -50%) scale(1);
  border-radius: 50%;
  opacity: 0;
  pointer-events: none;
  box-shadow: 0 2px 12px 0 rgba(60,60,70,0.11), 0 1.5px 8px 0 rgba(80,80,80,0.10) inset;
  background: #eaeaea;
  overflow: hidden;
  transition:
    width 0.55s cubic-bezier(.4,0,.2,1),
    height 0.55s cubic-bezier(.4,0,.2,1),
    left 0.55s cubic-bezier(.4,0,.2,1),
    top 0.55s cubic-bezier(.4,0,.2,1),
    border-radius 0.7s cubic-bezier(.4,0,.2,1),
    opacity 0.45s cubic-bezier(.4,0,.2,1),
    box-shadow 0.7s cubic-bezier(.4,0,.2,1);
  z-index: 10;
  filter: blur(0.3px) brightness(1.01);
}
#portal-preview iframe {
  width: 100%;
  height: 100%;
  border: none;
  filter: grayscale(0.25) blur(0.3px) contrast(0.93);
  background: #eaeaea;
  opacity: 0.97;
  transition: opacity 0.45s cubic-bezier(.4,0,.2,1);
}
#portal.blooming + #portal-preview {
  width: 320px;
  height: 180px;
  left: 50%;
  top: calc(50% - 54px);
  border-radius: 18px 18px 24px 24px / 22px 22px 32px 32px;
  opacity: 1;
  pointer-events: auto;
  box-shadow: 0 8px 40px 0 rgba(60,60,70,0.14), 0 1.5px 8px 0 rgba(80,80,80,0.10) inset;
  filter: blur(0.12px) brightness(1.02);
}
#portal.blooming + #portal-preview iframe {
  opacity: 1;
}


#portal {
  position: absolute;
  top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  width: 64px;
  height: 64px;
  border-radius: 50%;
  background: url('data:image/svg+xml;utf8,<svg width="64" height="64" xmlns="http://www.w3.org/2000/svg"><ellipse cx="32" cy="32" rx="29" ry="28" fill="%23bbb"/><ellipse cx="32" cy="34" rx="23" ry="20" fill="%23e0e0e0" fill-opacity="0.55"/><ellipse cx="36" cy="28" rx="10" ry="7" fill="%23fff" fill-opacity="0.14"/></svg>') center/cover no-repeat, linear-gradient(135deg,#c2c2c2 0%,#888 100%);
  box-shadow: 0 1px 8px 2px rgba(80,80,80,0.09) inset, 0 0 0 2px #bdbdbd;
  outline: none;
  cursor: pointer;
  z-index: 12;
  transition: filter 0.7s cubic-bezier(.4,0,.2,1), box-shadow 0.7s cubic-bezier(.4,0,.2,1), transform 0.7s cubic-bezier(.4,0,.2,1);
  filter: blur(0px) brightness(1);
  animation: portal-undulate 8s ease-in-out infinite alternate;
}
#portal:focus {
  box-shadow: 0 0 0 3px #d6d6d6, 0 1px 8px 2px rgba(80,80,80,0.09) inset;
}
#portal:hover, #portal:focus {
  filter: blur(0.7px) brightness(1.07) contrast(1.07) saturate(0.94);
}

#progress-indicator {
  position: fixed;
  top: 32px;
  right: 32px;
  width: 56px;
  height: 56px;
  z-index: 100;
  pointer-events: none;
  background: none;
  display: flex;
  align-items: center;
  justify-content: center;
}
#progress-indicator svg {
  width: 56px;
  height: 56px;
  display: block;
}
#progress-indicator .progress-bg {
  stroke: #e0e0e0;
  stroke-width: 5;
  fill: none;
}
#progress-indicator .progress-bar {
  stroke: gray;
  stroke-width: 5;
  fill: none;
  stroke-linecap: round;
  transition: stroke-dasharray 0.3s cubic-bezier(.4,0,.2,1);
}
#progress-indicator .progress-text {
  font-family: 'Amatic SC', sans-serif;
  font-size: 1.1rem;
  fill: #888;
  text-anchor: middle;
  dominant-baseline: middle;
  pointer-events: none;
}



#portal-fullscreen {
  position: fixed;
  left: 0; top: 0; right: 0; bottom: 0;
  width: 100vw;
  height: 100vh;
  background: #eaeaea;
  z-index: 999;
  display: flex;
  justify-content: center;
  align-items: center;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.7s cubic-bezier(.4,0,.2,1);
}
#portal-fullscreen.active {
  opacity: 1;
  pointer-events: auto;
}
#portal-fullscreen iframe {
  width: 90vw;
  height: 90vh;
  border: none;
  border-radius: 22px;
  box-shadow: 0 12px 48px 0 rgba(60,60,70,0.18);
  background: #eaeaea;
}
#portal-close {
  position: absolute;
  top: 28px;
  right: 38px;
  z-index: 1001;
  background: rgba(255,255,255,0.85);
  border: none;
  border-radius: 50%;
  width: 38px; height: 38px;
  font-size: 2rem;
  color: #444;
  box-shadow: 0 2px 12px rgba(80,80,80,0.09);
  cursor: pointer;
  transition: background 0.2s;
}
#portal-close:hover {
  background: #f3f3f3;
}

@media (max-width: 600px) {
  #portal {
    width: 38px;
    height: 38px;
    background-size: 38px 38px, cover;
  }
  #portal-preview {
    width: 92vw;
    height: 32vw;
    min-width: 180px;
    min-height: 80px;
    max-width: 98vw;
    max-height: 50vw;
  }
  #portal-fullscreen iframe {
    width: 98vw;
    height: 85vh;
    border-radius: 10px;
  }
}

@keyframes portal-undulate {
  0% { border-radius: 48% 52% 50% 50% / 48% 50% 52% 50%; }
  25% { border-radius: 51% 49% 52% 48% / 50% 52% 48% 50%; }
  50% { border-radius: 53% 47% 48% 52% / 52% 48% 50% 50%; }
  75% { border-radius: 47% 53% 51% 49% / 48% 50% 52% 50%; }
  100% { border-radius: 48% 52% 50% 50% / 48% 50% 52% 50%; }
}


/************************************
 *    Palais de Tokyo Poetic Enhancements
 ************************************/
.tokyo-title {
  font-family: 'Amatic SC', cursive;
  font-size: 2.8rem;
  letter-spacing: 0.04em;
  text-align: center;
  margin-top: 2.2rem;
  color: #444;
  font-weight: 700;
  text-shadow: 0 2px 12px rgba(180,180,180,0.13);
}
.tokyo-epigraph {
  font-family: 'Amatic SC', cursive;
  font-size: 1.3rem;
  text-align: center;
  color: #888;
  margin-bottom: 1.7rem;
  letter-spacing: 0.03em;
  font-style: italic;
}
.gallery-space {
  min-height: 100vh;
  width: 100vw;
  background: repeating-linear-gradient(135deg, #f7f7f7 0 80px, #f0f0f0 80px 160px);
  position: relative;
  overflow: hidden;
  padding-bottom: 4vh;
}
.hum-mute-btn {
  position: fixed;
  bottom: 36px;
  left: 36px;
  z-index: 1200;
  background: rgba(245,245,245,0.92);
  border: 1.5px solid #bbb;
  border-radius: 50%;
  width: 46px;
  height: 46px;
  font-size: 1.6rem;
  color: #888;
  box-shadow: 0 2px 12px rgba(120,120,120,0.11);
  cursor: pointer;
  transition: background 0.25s, border 0.25s, box-shadow 0.25s;
  outline: none;
}
.hum-mute-btn[aria-pressed="true"] {
  background: #e0e0e0;
  color: #666;
  border-color: #888;
  box-shadow: 0 4px 16px rgba(120,120,120,0.16);
}
.hum-mute-btn:focus {
  border: 2.5px solid #444;
  box-shadow: 0 0 0 3px #bdbdbd;
}
#portal-preview[role="dialog"],
#portal-fullscreen[role="dialog"] {
  border: 2.5px solid #bdbdbd;
  box-shadow: 0 8px 40px 0 rgba(60,60,70,0.16), 0 1.5px 8px 0 rgba(80,80,80,0.10) inset;
  background: #f9f9f7 url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="120" height="120" viewBox="0 0 120 120"><ellipse cx="60" cy="60" rx="54" ry="50" fill="none" stroke="%23bbb" stroke-width="1.5" opacity=".13"/></svg>') repeat;
  transition: box-shadow 0.6s cubic-bezier(.4,0,.2,1), border 0.5s cubic-bezier(.4,0,.2,1);
}
#portal {
  background-blend-mode: lighten;
  filter: blur(0.1px) brightness(1.04) grayscale(0.03) contrast(1.02);
  transition: filter 0.7s, box-shadow 0.7s, transform 0.7s;
}
#portal:focus, #portal:hover {
  box-shadow: 0 0 0 3.5px #d3d3d3, 0 1px 8px 2px rgba(80,80,80,0.13) inset;
  filter: blur(0.7px) brightness(1.10) contrast(1.11) saturate(0.96);
  outline: none;
}
button:focus, [role="button"]:focus, #crayon:focus, #portal:focus {
  outline: 2.5px solid #444;
  outline-offset: 2px;
  box-shadow: 0 0 0 3px #bdbdbd;
}
.paper-texture {
  background-image:
    url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="300" height="300" viewBox="0 0 300 300"><filter id="noise"><feTurbulence type="fractalNoise" baseFrequency="0.8" numOctaves="2"/></filter><rect width="300" height="300" fill="white"/><rect width="300" height="300" filter="url(%23noise)" opacity=".07"/></svg>');
  background-repeat: repeat;
  background-size: 300px 300px;
}
