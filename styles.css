/*******************************
 *    HIDE DEFAULT CURSOR ON BODY
 *******************************/
.hide-cursor {
  /* Use same crayon-optimized.png for cursor to maintain visual consistency */
  cursor: url('assets/crayon-optimized.png') 32 90, auto !important;
  /* Ensure cursor properties apply to all elements */
  * {
    cursor: inherit !important;
  }
}

/************************************
 *    BASIC PAGE & CONTAINER STYLE
 ************************************/
:root {
  --icon-brightness: 0.96;
  --shadow-opacity-base: 0.08;
  --portal-shadow-opacity: 0.16;
  --text-color: #666;
  /* Add more variables as needed for time-based shifts */
}

html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  overflow: hidden; /* Prevent scrolling */
  background-color: #f8f6f1; /* Soft warm ivory */
  font-family: 'Amatic SC', sans-serif;
  /* Subtle paper grain texture overlay - now animated */
  background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="400" height="400"><filter id="n" x="0" y="0"><feTurbulence type="fractalNoise" baseFrequency="0.95" numOctaves="1" seed="42" result="f"/><feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.02 0" result="m"/><feComposite operator="in" in="SourceGraphic" in2="m"/></filter><rect width="400" height="400" fill="%23f8f6f1"/><rect width="400" height="400" filter="url(%23n)"/></svg>');
  background-size: 450px 450px; /* Slightly larger pattern */
  animation: subtleBackgroundShift 180s linear infinite alternate; /* Very slow shift */
}

@keyframes subtleBackgroundShift {
  from { background-position: 0 0; }
  to { background-position: 50px 25px; }
}

.container {
  position: relative;
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}

/************************************
 *    CANVAS
 ************************************/
#canvas {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 1; /* Canvas behind other elements */
}

/************************************
 *    CRAYON - Creative Tool / Portal Opener
 ************************************/
#crayon {
  position: absolute;
  display: block;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(1);
  max-width: 120px;
  max-height: 120px;
  width: auto;
  height: auto;
  cursor: pointer;
  z-index: 4; /* Below portal/icons, above canvas */
  transform-origin: 50% 90%;
  transition: transform 0.27s cubic-bezier(.3,0,.2,1);
  filter: drop-shadow(0 2px 4px rgba(0,0,0,0.10));
}

@media (max-width: 600px) {
  #crayon {
    max-width: 90px;  /* Reduce crayon size on mobile */
    max-height: 90px; /* Reduce crayon size on mobile */
  }
}

/************************************
 *    MIRROR LINK (PORTAL) - Gateway / Reflection
 ************************************/
#mirror-link {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  display: block;
  width: 320px;
  height: 320px;
  max-width: 90vw;
  max-height: 90vw;
  min-width: 120px;
  min-height: 120px;
  pointer-events: none;
  z-index: 10;
  opacity: 0;
  background: transparent;
}

@media (max-width: 600px) {
  #mirror-link { /* Mobile size */
    width: min(50vw, 50vh);
    height: min(50vw, 50vh);
    min-width: 60px;
    min-height: 60px;
    max-width: 60vw;
    max-height: 60vw;
  }

  .container { /* Mobile centering */
    /* transform: translateX(3%); /* Removed transform for centering */ */
  }

  /* Combined icon styles for mobile */
  #ig-icon, #mail-icon {
    width: 32px; /* Keep smaller size for mobile */
    height: 32px; /* Ensure height matches width */
    bottom: 20px;
  }
  #ig-icon {
    left: 20px; /* Position near left edge */
  }
  #mail-icon {
    right: 20px; /* Position near right edge */
    left: auto; /* Override any inherited left */
  }
}

/************************************
 *    PORTAL
 ************************************/
#mirror {
  width: 100%;
  height: 100%;
  pointer-events: none;
  background: none;
  position: relative;
  /* JS now controls scale, opacity, blur */
  -webkit-mask-image: var(--portal-mask-url, url('assets/portal-mask.svg'));
  mask-image: var(--portal-mask-url, url('assets/portal-mask.svg'));
  -webkit-mask-size: cover;
  mask-size: cover;
  -webkit-mask-repeat: no-repeat;
  mask-repeat: no-repeat;
  -webkit-mask-position: center;
  mask-position: center;
  display: flex;
  align-items: center;
  justify-content: center;
  /* Initial state - JS will override */
  transform: scale(0.13);
  opacity: 0.10;
  filter: blur(8px);
}

#mirror-link.active #mirror {
  /* Restore base visibility for the active portal container */
  opacity: 1;
  background-color: rgba(30, 30, 30, 0.5); /* Subtle dark presence */
  /* Ensure mask is applied if needed for shape */
  -webkit-mask-image: inherit;
  mask-image: inherit;
  /* Ensure transition applies if needed */
  transition: opacity 1.1s cubic-bezier(.2,.8,.2,1), background-color 1.1s cubic-bezier(.2,.8,.2,1), filter 1.1s cubic-bezier(.2,.8,.2,1);
  transform: scale(1);
  filter: blur(2.5px);
}

#mirror-link.active {
  opacity: 1; /* Make link container receptive */
  pointer-events: auto; /* Allow hover/focus */
}

/************************************
 *    PORTAL PREVIEW
 ************************************/
#portal-preview-container {
  width: 100%;
  height: 100%;
  border-radius: 50%;
  /* Remove overflow:hidden to allow billboard to extend outside */
  overflow: visible;
  position: relative;
}

#mirror-iframe {
  position: fixed;
  left: 50%;
  top: 50%;
  width: 30vw;
  height: 16.875vw; /* 16:9 aspect ratio */
  max-width: 45vw;
  max-height: 25.3125vw;
  min-width: 160px;
  min-height: 90px;
  transform: translate(-50%, -50%) scale(0.92);
  opacity: 0;
  background: #181818;
  border: 1.75vw solid #111; /* Letterbox bars for cinematic effect */
  box-sizing: border-box;
  box-shadow: 0 0 32px 6px rgba(80,80,80, var(--portal-shadow-opacity, 0.16)), 0 0 0 1px rgba(160,160,160,0.13);
  border-radius: 12px;
  filter: grayscale(1) blur(8px) brightness(0.94) contrast(0.92);
  pointer-events: none;
  z-index: 100;
  transition: opacity 1.15s cubic-bezier(.2,.8,.2,1),
              transform 1.15s cubic-bezier(.2,.8,.2,1),
              filter 1.15s cubic-bezier(.2,.8,.2,1);
}

/************************************
 *    PORTAL HOVER
 ************************************/
#mirror-link.active:hover #mirror-iframe {
  opacity: 1;
  transform: translate(-50%, -50%) scale(1.04);
  filter: grayscale(1) blur(2.5px) brightness(0.97) contrast(0.95);
}

/************************************
 *    PORTAL FOCUS
 ************************************/
#mirror-link.active:focus #mirror-iframe,
#mirror-link.active:hover #mirror-iframe {
  opacity: 1;
  transform: translate(-50%, -50%) scale(1.04);
  filter: grayscale(1) blur(2.5px) brightness(0.97) contrast(0.95);
  border: 1px solid rgba(160,160,160,0.25);
}

/************************************
 *    ICONS
 ************************************/
#ig-icon, #mail-icon {
  position: fixed;
  bottom: 28px;
  width: 160px; /* 4x size */
  height: 160px; /* 4x size */
  object-fit: contain; /* Prevent distortion */
  opacity: 0;
  filter: grayscale(1) brightness(var(--icon-brightness)) drop-shadow(0 2px 6px rgba(90,90,90, var(--shadow-opacity-base)));
  transition: opacity 0.85s cubic-bezier(.2,.8,.2,1) 0.1s,
              filter 0.4s ease;
  pointer-events: none;
  z-index: 110;
}

#ig-icon {
  left: calc(50% - 170px); /* Increased spacing for 160px width + gap */
}

#mail-icon {
  left: calc(50% + 170px); /* Increased spacing for 160px width + gap */
  transition-delay: 0.18s; /* Slightly later fade */
}

/************************************
 *    ICON HOVER
 ************************************/
#mirror-link.active ~ #ig-icon,
#mirror-link.active ~ #mail-icon {
  opacity: 1;
  pointer-events: auto;
}

#mirror-link.active ~ #ig-link > #ig-icon,
#mirror-link.active ~ #mail-link > #mail-icon,
#mirror-link.active + #ig-link > #ig-icon,
#mirror-link.active + #ig-link + #mail-link > #mail-icon,
#mirror-link.active ~ #ig-link,
#mirror-link.active ~ #mail-link {
  opacity: 1;
  pointer-events: auto;
}

/* Fallback for direct children (most robust) */
#mirror-link.active ~ a > img {
  opacity: 1;
  pointer-events: auto;
}
#mirror-link.active ~ a {
  pointer-events: auto;
}

/************************************
 *    ICON HOVER EFFECTS
 ************************************/
#ig-icon:hover, #ig-icon:focus,
#mail-icon:hover, #mail-icon:focus {
  filter: grayscale(1) brightness(1.13) drop-shadow(0 4px 12px rgba(90,90,90, var(--shadow-opacity-base)));
  outline: none;
}

/************************************
 *    HOVER TEXT
 ************************************/
.hover-text {
  position: absolute;
  bottom: -30px; /* Adjust slightly for typing animation */
  left: 50%;
  transform: translateX(-50%);
  font-family: 'lvvvdy', cursive, sans-serif;
  font-size: 20px;
  color: var(--text-color, #666);
  opacity: 0; /* Start fully transparent */
  transition: opacity 1.5s ease;
  white-space: nowrap;
  pointer-events: none;
}

.hover-text.visible {
  opacity: 0.7;
}

/************************************
 *    ICON HOVER EFFECTS
 ************************************/
#ig-link:hover,
#mail-link:hover {
  cursor: url('assets/graphite-dot.cur'), auto; /* Placeholder cursor */
  /* Placeholder graphite dust - subtle expanding shadow */
  /* We might need pseudo-elements for a better dust texture */
}

#ig-link:hover #ig-icon,
#mail-link:hover #mail-icon {
   box-shadow: 0 0 15px 5px rgba(100, 100, 100, calc(var(--shadow-opacity-base) + 0.05)); 
   transition: box-shadow 0.6s ease-out;
}

/************************************
 *    FONT FACE
 ************************************/
@font-face {
  font-family: 'lvvvdy';
  src: url('assets/Lvvvdy.otf') format('opentype');
  font-weight: normal;
  font-style: normal;
  font-display: swap;
}

/************************************
 *    ANIMATIONS
 ************************************/
@keyframes fadeInSlow {
  from { opacity: 0; }
  to { opacity: 0.7; }
}

@keyframes fadeOutSlow {
  from { opacity: 0.7; }
  to { opacity: 0; }
}

@keyframes tremble {
  0%, 100% { transform: translate(0, 0) rotate(0); }
  25% { transform: translate(1px, 0) rotate(1deg); }
  75% { transform: translate(-1px, 0) rotate(-1deg); }
}

@keyframes pulseOutward {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.03); }
}

@keyframes shudder {
  0%, 100% { transform: translate(0, 0); }
  20% { transform: translate(-2px, 1px); }
  40% { transform: translate(2px, -1px); }
  60% { transform: translate(-1px, 1px); }
  80% { transform: translate(1px, -1px); }
}

@keyframes flicker {
  0%, 100% { opacity: 1; filter: brightness(1); }
  50% { opacity: 0.9; filter: brightness(1.1); }
}

#mail-icon.trembling {
  animation: tremble 0.2s ease-in-out 1;
}

#ig-icon.pulsing {
   animation: pulseOutward 0.5s ease-out 1;
}

#mail-icon.shuddering {
  animation: shudder 0.3s linear 1;
}

#ig-icon.flickering {
  animation: flicker 0.15s linear 2;
}
